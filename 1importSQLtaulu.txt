DROP DATABASE IF EXISTS whispertest;
CREATE DATABASE whispertest;
USE whispertest;

drop table if exists player;
drop table if exists NPC;
drop table if exists item;
drop table if exists item_type;
drop table if exists map;
drop table if exists enemy;
drop table if exists enemy_type;
drop table if exists terrain_type;

CREATE TABLE IF NOT EXISTS `item_type` (
  `id` int(11) NOT NULL,
  `name` varchar(30) NOT NULL,
  `att` int(11) DEFAULT NULL,
  `defense` int(11) DEFAULT NULL,
  `healing` int(11) DEFAULT NULL,
  `weight` decimal(10,0) DEFAULT NULL,
  `description` varchar(1000) DEFAULT NULL,
  `text` varchar(1000) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;



CREATE TABLE IF NOT EXISTS `terrain_type` (
  `id` int(11) NOT NULL,
  `name` varchar(25) NOT NULL,
  `movement_difficulty` decimal(10,0) NOT NULL,
  `description` varchar(1000) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE enemy_type
(
	id INT NOT NULL,
	name varchar(25) NOT NULL,
	hp INT NOT NULL,
	att INT NOT NULL,
	speed DECIMAL(10) NOT NULL,
	PRIMARY KEY (id)
  
);





CREATE TABLE IF NOT EXISTS `terrain_square` (
  `x` int(11) NOT NULL,
  `y` int(11) NOT NULL,
  `type_id` int(11) NOT NULL,
  `restriction` varchar(4) DEFAULT NULL,
  `area` int(11) DEFAULT NULL,
  `description` varchar(1000) DEFAULT NULL,
  PRIMARY KEY (`x`,`y`),
  KEY `type_id` (`type_id`),
  CONSTRAINT `terrain_square_ibfk_1` FOREIGN KEY (`type_id`) REFERENCES `terrain_type` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;


CREATE TABLE NPC
(
	id INT NOT NULL,
	name varchar(20) NOT NULL,
	att INT NOT NULL,
	hp INT NOT NULL,
	enemy INT NOT NULL,
	x INT NOT NULL,
	y INT NOT NULL,
	PRIMARY KEY (id),
	FOREIGN KEY (x, y) REFERENCES terrain_square(x, y)
);


CREATE TABLE enemy
(
	id INT NOT NULL,
	type_id INT NOT NULL,
	x INT,
	y INT,
	PRIMARY KEY (id),
	FOREIGN KEY (type_id) REFERENCES enemy_type(id),
	FOREIGN KEY (x, y) REFERENCES terrain_square(x, y)
);



CREATE TABLE player
(
	ID INT NOT NULL,
	name VARCHAR(40) NOT NULL,
	carry INT NOT NULL,
	att INT,
	speed DECIMAL(10),
	hp INT NOT NULL,
	fatigue INT NOT NULL,
	x INT NOT NULL,
	y INT NOT NULL,
	PRIMARY KEY (id),
	FOREIGN KEY (x, y) REFERENCES terrain_square(x, y)
);


CREATE TABLE item
(
	id INT NOT NULL,
	type_id INT NOT NULL,
	x INT NOT NULL,
	y INT NOT NULL,
	player_ID INT NOT NULL,
	PRIMARY KEY (id),
	FOREIGN KEY (type_id) REFERENCES item_type(id),
	FOREIGN KEY (x, y) REFERENCES terrain_square(x, y),
	FOREIGN KEY (player_ID) REFERENCES player(ID)
);


